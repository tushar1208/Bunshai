<!-- chatbot_ui.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sharsh - BunShai TECHNOHUB AI Assistant</title>
    <style>
        :root {
            --primary: #7d0022;
            --primary-dark: #5a0018;
            --primary-light: #a73356;
            --dark: #0f172a;
            --dark-light: #1e293b;
            --light: #f8fafc;
            --light-dark: #e2e8f0;
            --ai-bg: #f3f4f6;
            --user-bg: #7d0022;
            --ai-text: #1f2937;
            --user-text: #ffffff;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.15);
            --border-radius: 12px;
            --border-radius-sm: 8px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, var(--dark), var(--dark-light));
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .chatbot-container {
            width: 100%;
            max-width: 800px;
            height: 90vh;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* Header */
        .chatbot-header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 20px 25px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .chatbot-brand {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .chatbot-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border: 3px solid rgba(255, 255, 255, 0.3);
            box-shadow: var(--shadow);
        }

        .chatbot-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .chatbot-info h2 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .chatbot-info p {
            font-size: 0.9rem;
            opacity: 0.9;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #10b981;
            display: inline-block;
            animation: pulse 2s infinite;
        }

        .chatbot-controls {
            display: flex;
            gap: 10px;
        }

        .control-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            font-size: 1.1rem;
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        /* Chat Messages */
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 25px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            background: var(--light);
        }

        .message {
            max-width: 80%;
            padding: 15px 20px;
            border-radius: var(--border-radius);
            position: relative;
            animation: slideIn 0.3s ease;
            word-wrap: break-word;
        }

        .ai-message {
            background: var(--ai-bg);
            color: var(--ai-text);
            align-self: flex-start;
            border-bottom-left-radius: 5px;
        }

        .user-message {
            background: var(--user-bg);
            color: var(--user-text);
            align-self: flex-end;
            border-bottom-right-radius: 5px;
        }

        .message-content {
            line-height: 1.5;
        }

        .message-content p {
            margin-bottom: 10px;
        }

        .message-content p:last-child {
            margin-bottom: 0;
        }

        .message-content ul, .message-content ol {
            padding-left: 20px;
            margin: 10px 0;
        }

        .message-content li {
            margin-bottom: 5px;
        }

        .message-content code {
            background: rgba(0, 0, 0, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .message-time {
            font-size: 0.75rem;
            opacity: 0.7;
            margin-top: 8px;
            text-align: right;
        }

        .ai-message .message-time {
            color: var(--dark-light);
        }

        .user-message .message-time {
            color: rgba(255, 255, 255, 0.7);
        }

        /* Typing Indicator */
        .typing-indicator {
            background: var(--ai-bg);
            color: var(--ai-text);
            padding: 15px 20px;
            border-radius: var(--border-radius);
            align-self: flex-start;
            border-bottom-left-radius: 5px;
            display: flex;
            align-items: center;
            gap: 10px;
            min-height: 60px;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--dark-light);
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        /* Quick Actions */
        .quick-actions {
            padding: 15px 25px;
            border-top: 1px solid var(--light-dark);
            background: white;
            display: flex;
            gap: 10px;
            overflow-x: auto;
            scrollbar-width: none;
        }

        .quick-actions::-webkit-scrollbar {
            display: none;
        }

        .quick-action-btn {
            background: var(--light);
            border: 1px solid var(--light-dark);
            color: var(--dark);
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .quick-action-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        /* Input Area */
        .input-area {
            padding: 20px 25px;
            border-top: 1px solid var(--light-dark);
            background: white;
            display: flex;
            gap: 15px;
            align-items: flex-end;
        }

        .input-wrapper {
            flex: 1;
            position: relative;
        }

        #chat-input {
            width: 100%;
            padding: 15px 50px 15px 20px;
            border: 2px solid var(--light-dark);
            border-radius: 25px;
            font-size: 1rem;
            transition: var(--transition);
            resize: none;
            min-height: 50px;
            max-height: 120px;
            line-height: 1.5;
            font-family: inherit;
        }

        #chat-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(125, 0, 34, 0.1);
        }

        .input-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--dark-light);
            cursor: pointer;
            transition: var(--transition);
        }

        .input-icon:hover {
            color: var(--primary);
        }

        .send-btn {
            background: var(--primary);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .send-btn:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }

        .send-btn:disabled {
            background: var(--light-dark);
            cursor: not-allowed;
            transform: none;
        }

        /* Features Grid */
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .feature-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: var(--border-radius-sm);
            text-align: center;
            transition: var(--transition);
            cursor: pointer;
        }

        .feature-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-3px);
        }

        .feature-item i {
            font-size: 1.5rem;
            color: var(--primary);
            margin-bottom: 10px;
            display: block;
        }

        .feature-item span {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* Welcome Message */
        .welcome-message {
            background: linear-gradient(135deg, rgba(125, 0, 34, 0.1), rgba(167, 51, 86, 0.1));
            border-left: 4px solid var(--primary);
            padding: 25px;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
        }

        .welcome-message h3 {
            color: var(--dark);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .welcome-message h3 i {
            color: var(--primary);
        }

        .welcome-message p {
            color: var(--dark-light);
            margin-bottom: 15px;
        }

        /* Suggestions */
        .suggestions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .suggestion-item {
            background: white;
            border: 1px solid var(--light-dark);
            border-radius: var(--border-radius-sm);
            padding: 15px;
            cursor: pointer;
            transition: var(--transition);
        }

        .suggestion-item:hover {
            border-color: var(--primary);
            box-shadow: var(--shadow);
            transform: translateY(-2px);
        }

        .suggestion-item h4 {
            color: var(--dark);
            margin-bottom: 8px;
            font-size: 1rem;
        }

        .suggestion-item p {
            color: var(--dark-light);
            font-size: 0.85rem;
            line-height: 1.4;
        }

        /* Animations */
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
            }
            30% {
                transform: translateY(-5px);
            }
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }

        /* Scrollbar Styling */
        .chat-messages::-webkit-scrollbar {
            width: 6px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: var(--light);
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: var(--light-dark);
            border-radius: 3px;
        }

        .chat-messages::-webkit-scrollbar-thumb:hover {
            background: var(--dark-light);
        }

        /* Loading Screen */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--dark);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }

        .loading-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        .loading-text {
            color: white;
            font-size: 1.1rem;
            opacity: 0.8;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .chatbot-container {
                height: 100vh;
                border-radius: 0;
            }

            body {
                padding: 0;
            }

            .chatbot-header {
                padding: 15px 20px;
            }

            .chat-messages {
                padding: 20px 15px;
            }

            .input-area {
                padding: 15px 20px;
            }

            .message {
                max-width: 90%;
            }

            .features-grid,
            .suggestions-grid {
                grid-template-columns: 1fr;
            }

            .quick-actions {
                padding: 12px 15px;
            }

            .quick-action-btn {
                padding: 8px 15px;
                font-size: 0.85rem;
            }
        }

        @media (max-width: 480px) {
            .chatbot-info h2 {
                font-size: 1.3rem;
            }

            .chatbot-info p {
                font-size: 0.8rem;
            }

            .control-btn {
                width: 35px;
                height: 35px;
            }

            .message {
                padding: 12px 15px;
                font-size: 0.95rem;
            }

            #chat-input {
                padding: 12px 45px 12px 15px;
                font-size: 0.95rem;
            }

            .send-btn {
                width: 45px;
                height: 45px;
            }
        }

        /* Dark Mode Support */
        @media (prefers-color-scheme: dark) {
            body {
                background: linear-gradient(135deg, #0a0f1c, #121827);
            }

            .chatbot-container {
                background: #1a1f2e;
                color: #e2e8f0;
            }

            .ai-message {
                background: #2d3748;
                color: #e2e8f0;
            }

            .user-message {
                background: var(--primary);
                color: white;
            }

            .chat-messages {
                background: #141a26;
            }

            .quick-actions {
                background: #1a1f2e;
                border-top-color: #2d3748;
            }

            .quick-action-btn {
                background: #2d3748;
                border-color: #4a5568;
                color: #e2e8f0;
            }

            .input-area {
                background: #1a1f2e;
                border-top-color: #2d3748;
            }

            #chat-input {
                background: #2d3748;
                border-color: #4a5568;
                color: #e2e8f0;
            }

            #chat-input::placeholder {
                color: #a0aec0;
            }

            .input-icon {
                color: #a0aec0;
            }

            .suggestion-item {
                background: #2d3748;
                border-color: #4a5568;
                color: #e2e8f0;
            }

            .suggestion-item h4 {
                color: #e2e8f0;
            }

            .suggestion-item p {
                color: #a0aec0;
            }

            .welcome-message {
                background: linear-gradient(135deg, rgba(125, 0, 34, 0.2), rgba(167, 51, 86, 0.2));
                border-left-color: var(--primary);
            }

            .welcome-message h3 {
                color: #e2e8f0;
            }

            .welcome-message p {
                color: #a0aec0;
            }

            .feature-item {
                background: rgba(255, 255, 255, 0.05);
            }

            .feature-item:hover {
                background: rgba(255, 255, 255, 0.1);
            }

            .chat-messages::-webkit-scrollbar-track {
                background: #1a1f2e;
            }

            .chat-messages::-webkit-scrollbar-thumb {
                background: #4a5568;
            }
        }

        /* Accessibility */
        .visually-hidden {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Focus styles */
        button:focus,
        input:focus,
        textarea:focus {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }

        /* Reduced motion */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-spinner"></div>
        <div class="loading-text">Initializing Sharsh AI Assistant...</div>
    </div>

    <!-- Chatbot Container -->
    <div class="chatbot-container">
        <!-- Header -->
        <div class="chatbot-header">
            <div class="chatbot-brand">
                <div class="chatbot-avatar">
                    <img src="{% static 'images/chatbot/sharsh-icon.png' %}" alt="Sharsh AI Assistant" 
                         onerror="this.src='https://api.dicebear.com/7.x/bottts/svg?seed=sharsh&backgroundColor=7d0022&radius=50'">
                </div>
                <div class="chatbot-info">
                    <h2>Sharsh AI Assistant</h2>
                    <p>
                        <span class="status-indicator"></span>
                        Online â€¢ BunShai TECHNOHUB
                    </p>
                </div>
            </div>
            <div class="chatbot-controls">
                <button class="control-btn" title="Minimize" onclick="minimizeChat()">
                    <i class="fas fa-minus"></i>
                </button>
                <button class="control-btn" title="Clear Chat" onclick="clearChat()">
                    <i class="fas fa-trash"></i>
                </button>
                <button class="control-btn" title="Settings" onclick="openSettings()">
                    <i class="fas fa-cog"></i>
                </button>
            </div>
        </div>

        <!-- Chat Messages -->
        <div class="chat-messages" id="chatMessages">
            <!-- Welcome Message -->
            <div class="welcome-message">
                <h3><i class="fas fa-robot"></i> Hello! I'm Sharsh, your AI Assistant</h3>
                <p>I'm here to help you with BunShai TECHNOHUB services, answer questions, and provide support 24/7. How can I assist you today?</p>
                
                <div class="suggestions-grid">
                    <div class="suggestion-item" onclick="quickQuestion('Tell me about your services')">
                        <h4><i class="fas fa-cogs"></i> Our Services</h4>
                        <p>Learn about IT consulting, development, and more</p>
                    </div>
                    <div class="suggestion-item" onclick="quickQuestion('How to contact support')">
                        <h4><i class="fas fa-headset"></i> Contact Support</h4>
                        <p>Get help with technical issues or questions</p>
                    </div>
                    <div class="suggestion-item" onclick="quickQuestion('Pricing information')">
                        <h4><i class="fas fa-tags"></i> Pricing</h4>
                        <p>Learn about our service packages</p>
                    </div>
                    <div class="suggestion-item" onclick="quickQuestion('Book a consultation')">
                        <h4><i class="fas fa-calendar-check"></i> Book Consultation</h4>
                        <p>Schedule a meeting with our experts</p>
                    </div>
                </div>
            </div>

            <!-- AI Initial Message -->
            <div class="message ai-message">
                <div class="message-content">
                    <p>ðŸ‘‹ Welcome! I'm Sharsh, your intelligent assistant from BunShai TECHNOHUB. I can help you with:</p>
                    <ul>
                        <li><strong>Service Information:</strong> Learn about our IT solutions</li>
                        <li><strong>Technical Support:</strong> Get help with issues</li>
                        <li><strong>Project Quotes:</strong> Get estimated pricing</li>
                        <li><strong>Documentation:</strong> Access guides and tutorials</li>
                        <li><strong>Appointment Booking:</strong> Schedule consultations</li>
                    </ul>
                    <p>What would you like to know today?</p>
                </div>
                <div class="message-time">Just now</div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="quick-actions">
            <button class="quick-action-btn" onclick="quickQuestion('Website development services')">
                <i class="fas fa-laptop-code"></i> Web Development
            </button>
            <button class="quick-action-btn" onclick="quickQuestion('Cloud solutions pricing')">
                <i class="fas fa-cloud"></i> Cloud Solutions
            </button>
            <button class="quick-action-btn" onclick="quickQuestion('Cybersecurity services')">
                <i class="fas fa-shield-alt"></i> Cybersecurity
            </button>
            <button class="quick-action-btn" onclick="quickQuestion('Mobile app development')">
                <i class="fas fa-mobile-alt"></i> Mobile Apps
            </button>
            <button class="quick-action-btn" onclick="quickQuestion('Contact sales team')">
                <i class="fas fa-phone-alt"></i> Contact Sales
            </button>
            <button class="quick-action-btn" onclick="quickQuestion('View case studies')">
                <i class="fas fa-chart-line"></i> Case Studies
            </button>
        </div>

        <!-- Input Area -->
        <div class="input-area">
            <div class="input-wrapper">
                <textarea 
                    id="chat-input" 
                    placeholder="Type your message here... Press Shift+Enter for new line" 
                    rows="1"
                    oninput="autoResize(this)"
                    onkeydown="handleKeyPress(event)"
                ></textarea>
                <div class="input-icon" onclick="openAttachmentMenu()" title="Attach file">
                    <i class="fas fa-paperclip"></i>
                </div>
            </div>
            <button class="send-btn" id="sendButton" onclick="sendMessage()" title="Send message">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <!-- Features Modal -->
    <div class="features-modal" id="featuresModal" style="display: none;">
        <div class="modal-content">
            <h3><i class="fas fa-magic"></i> AI Features</h3>
            <div class="features-grid">
                <div class="feature-item" onclick="activateFeature('code_generation')">
                    <i class="fas fa-code"></i>
                    <span>Code Generation</span>
                </div>
                <div class="feature-item" onclick="activateFeature('document_analysis')">
                    <i class="fas fa-file-alt"></i>
                    <span>Document Analysis</span>
                </div>
                <div class="feature-item" onclick="activateFeature('image_processing')">
                    <i class="fas fa-image"></i>
                    <span>Image Processing</span>
                </div>
                <div class="feature-item" onclick="activateFeature('data_analysis')">
                    <i class="fas fa-chart-bar"></i>
                    <span>Data Analysis</span>
                </div>
                <div class="feature-item" onclick="activateFeature('translation')">
                    <i class="fas fa-language"></i>
                    <span>Translation</span>
                </div>
                <div class="feature-item" onclick="activateFeature('summary')">
                    <i class="fas fa-file-contract"></i>
                    <span>Text Summary</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // DOM Elements
        const chatMessages = document.getElementById('chatMessages');
        const chatInput = document.getElementById('chat-input');
        const sendButton = document.getElementById('sendButton');
        const loadingScreen = document.getElementById('loadingScreen');

        // Initialize chat
        let chatHistory = [];
        let isTyping = false;

        // Auto-resize textarea
        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 120) + 'px';
        }

        // Handle keyboard shortcuts
        function handleKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
            
            // Ctrl + / for features
            if (event.ctrlKey && event.key === '/') {
                event.preventDefault();
                toggleFeaturesModal();
            }
            
            // Esc to clear input
            if (event.key === 'Escape') {
                chatInput.value = '';
                autoResize(chatInput);
            }
        }

        // Send message
        async function sendMessage() {
            const message = chatInput.value.trim();
            if (!message || isTyping) return;

            // Add user message
            addMessage(message, 'user');
            chatInput.value = '';
            autoResize(chatInput);
            sendButton.disabled = true;

            // Show typing indicator
            showTypingIndicator();

            // Store in history
            chatHistory.push({ role: 'user', content: message });

            try {
                // Get AI response (simulated for demo)
                const response = await getAIResponse(message);
                
                // Remove typing indicator
                removeTypingIndicator();
                
                // Add AI response
                addMessage(response, 'ai');
                
                // Store in history
                chatHistory.push({ role: 'assistant', content: response });
                
                // Scroll to bottom
                scrollToBottom();
                
            } catch (error) {
                console.error('Error:', error);
                removeTypingIndicator();
                addMessage('Sorry, I encountered an error. Please try again.', 'ai');
            }

            sendButton.disabled = false;
        }

        // Add message to chat
        function addMessage(content, sender) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}-message`;
            
            const time = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            
            // Format message content with basic markdown
            let formattedContent = content
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.*?)\*/g, '<em>$1</em>')
                .replace(/`(.*?)`/g, '<code>$1</code>')
                .replace(/\n/g, '<br>');
            
            // Convert URLs to links
            formattedContent = formattedContent.replace(
                /(https?:\/\/[^\s]+)/g,
                '<a href="$1" target="_blank" style="color: inherit; text-decoration: underline;">$1</a>'
            );
            
            messageDiv.innerHTML = `
                <div class="message-content">${formattedContent}</div>
                <div class="message-time">${time}</div>
            `;
            
            chatMessages.appendChild(messageDiv);
            scrollToBottom();
        }

        // Show typing indicator
        function showTypingIndicator() {
            isTyping = true;
            const typingDiv = document.createElement('div');
            typingDiv.className = 'typing-indicator';
            typingDiv.id = 'typingIndicator';
            typingDiv.innerHTML = `
                <div class="typing-dots">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
                <span>Sharsh is typing...</span>
            `;
            chatMessages.appendChild(typingDiv);
            scrollToBottom();
        }

        // Remove typing indicator
        function removeTypingIndicator() {
            isTyping = false;
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        // Get AI response (simulated)
        async function getAIResponse(message) {
            // Simulate API delay
            await new Promise(resolve => setTimeout(resolve, 1000 + Math.random() * 2000));
            
            // Predefined responses for demo
            const responses = {
                greetings: [
                    "Hello! How can I help you with BunShai TECHNOHUB services today?",
                    "Hi there! I'm Sharsh, ready to assist you with your technology needs.",
                    "Welcome! I'm here to provide information about our IT solutions and support."
                ],
                services: "BunShai TECHNOHUB offers comprehensive IT services including:\n\n" +
                         "â€¢ **Web Development**: Custom websites and web applications\n" +
                         "â€¢ **Mobile Apps**: iOS and Android applications\n" +
                         "â€¢ **Cloud Solutions**: AWS, Azure, and Google Cloud services\n" +
                         "â€¢ **Cybersecurity**: Security audits and protection\n" +
                         "â€¢ **Data Analytics**: Business intelligence and insights\n\n" +
                         "Which service are you interested in?",
                pricing: "Our pricing varies based on project requirements. We offer:\n\n" +
                        "â€¢ **Basic Plan**: Starting at $2,000 for simple websites\n" +
                        "â€¢ **Professional Plan**: Starting at $5,000 for business applications\n" +
                        "â€¢ **Enterprise Plan**: Custom pricing for complex solutions\n\n" +
                        "Would you like a personalized quote?",
                support: "For technical support, you can:\n\n" +
                        "â€¢ **Call**: +91 8091700280 (9 AM - 6 PM IST)\n" +
                        "â€¢ **Email**: support@bunshai.com\n" +
                        "â€¢ **Live Chat**: Available on our website\n" +
                        "â€¢ **Emergency**: +91 8091401208 (24/7)\n\n" +
                        "What specific issue are you facing?",
                contact: "You can reach our team through:\n\n" +
                        "â€¢ **Email**: info@bunshai.com\n" +
                        "â€¢ **Phone**: +91 8091401208\n" +
                        "â€¢ **WhatsApp**: https://wa.me/918091401208\n" +
                        "â€¢ **LinkedIn**: https://linkedin.com/company/bunshai-technohub\n\n" +
                        "Would you like me to help you schedule a consultation?",
                default: "I understand you're asking about: \"" + message + "\"\n\n" +
                        "I can help you with:\n" +
                        "1. Service information and details\n" +
                        "2. Pricing and package options\n" +
                        "3. Technical support and troubleshooting\n" +
                        "4. Appointment scheduling\n" +
                        "5. Project consultation\n\n" +
                        "Could you provide more details about what you need?"
            };

            // Determine response based on keywords
            const lowerMessage = message.toLowerCase();
            
            if (lowerMessage.includes('hello') || lowerMessage.includes('hi') || lowerMessage.includes('hey')) {
                return responses.greetings[Math.floor(Math.random() * responses.greetings.length)];
            } else if (lowerMessage.includes('service') || lowerMessage.includes('offer') || lowerMessage.includes('provide')) {
                return responses.services;
            } else if (lowerMessage.includes('price') || lowerMessage.includes('cost') || lowerMessage.includes('quote')) {
                return responses.pricing;
            } else if (lowerMessage.includes('support') || lowerMessage.includes('help') || lowerMessage.includes('issue')) {
                return responses.support;
            } else if (lowerMessage.includes('contact') || lowerMessage.includes('call') || lowerMessage.includes('email')) {
                return responses.contact;
            } else {
                return responses.default;
            }
        }

        // Quick question buttons
        function quickQuestion(question) {
            chatInput.value = question;
            autoResize(chatInput);
            sendMessage();
        }

        // Clear chat
        function clearChat() {
            if (confirm('Are you sure you want to clear the chat history?')) {
                chatMessages.innerHTML = '';
                chatHistory = [];
                
                // Add welcome message back
                const welcomeMessage = document.querySelector('.welcome-message');
                if (!welcomeMessage) {
                    const welcomeDiv = document.createElement('div');
                    welcomeDiv.className = 'welcome-message';
                    welcomeDiv.innerHTML = `
                        <h3><i class="fas fa-robot"></i> Chat Cleared</h3>
                        <p>How can I assist you today?</p>
                    `;
                    chatMessages.appendChild(welcomeDiv);
                }
                
                addMessage("I've cleared our conversation history. How can I help you now?", 'ai');
            }
        }

        // Minimize chat (simulated)
        function minimizeChat() {
            alert('Chat minimized. (In production, this would minimize the chat window)');
        }

        // Open settings
        function openSettings() {
            alert('Settings panel would open here with options for:\n\n' +
                  'â€¢ Voice settings\n' +
                  'â€¢ Language preferences\n' +
                  'â€¢ Notification settings\n' +
                  'â€¢ Data privacy options');
        }

        // Open attachment menu
        function openAttachmentMenu() {
            alert('Attachment options:\n\n' +
                  'â€¢ Upload image\n' +
                  'â€¢ Upload document\n' +
                  'â€¢ Upload code file\n' +
                  'â€¢ Take photo\n' +
                  'â€¢ Record audio');
        }

        // Toggle features modal
        function toggleFeaturesModal() {
            const modal = document.getElementById('featuresModal');
            modal.style.display = modal.style.display === 'none' ? 'block' : 'none';
        }

        // Activate feature
        function activateFeature(feature) {
            const features = {
                code_generation: "Code generation activated! Please describe what code you need.",
                document_analysis: "Document analysis ready! Upload your document for review.",
                image_processing: "Image processing enabled! Upload or describe your image.",
                data_analysis: "Data analysis mode activated! Share your dataset or requirements.",
                translation: "Translation service ready! Enter text to translate.",
                summary: "Text summarization enabled! Paste your text for a summary."
            };
            
            addMessage(features[feature], 'ai');
            toggleFeaturesModal();
        }

        // Scroll to bottom
        function scrollToBottom() {
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Hide loading screen
            setTimeout(() => {
                loadingScreen.classList.add('hidden');
            }, 1500);

            // Focus on input
            chatInput.focus();

            // Load previous chat from localStorage
            const savedChat = localStorage.getItem('sharsh_chat_history');
            if (savedChat) {
                try {
                    const messages = JSON.parse(savedChat);
                    messages.forEach(msg => {
                        if (msg.role && msg.content) {
                            addMessage(msg.content, msg.role === 'user' ? 'user' : 'ai');
                        }
                    });
                } catch (e) {
                    console.error('Error loading chat history:', e);
                }
            }

            // Auto-save chat
            setInterval(() => {
                if (chatHistory.length > 0) {
                    localStorage.setItem('sharsh_chat_history', JSON.stringify(chatHistory));
                }
            }, 10000);

            // Voice recognition (if supported)
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                const recognition = new SpeechRecognition();
                
                recognition.continuous = false;
                recognition.interimResults = false;
                
                recognition.onresult = function(event) {
                    const transcript = event.results[0][0].transcript;
                    chatInput.value = transcript;
                    autoResize(chatInput);
                };
                
                // Add voice button
                const voiceBtn = document.createElement('div');
                voiceBtn.className = 'input-icon';
                voiceBtn.style.right = '45px';
                voiceBtn.innerHTML = '<i class="fas fa-microphone" title="Voice input"></i>';
                voiceBtn.onclick = () => recognition.start();
                document.querySelector('.input-wrapper').appendChild(voiceBtn);
            }

            // Welcome notification
            setTimeout(() => {
                if (!localStorage.getItem('sharsh_welcome_shown')) {
                    const notification = document.createElement('div');
                    notification.className = 'message ai-message';
                    notification.innerHTML = `
                        <div class="message-content">
                            <p><strong>ðŸ’¡ Quick Tip:</strong> You can use the quick action buttons below for common queries!</p>
                        </div>
                    `;
                    chatMessages.appendChild(notification);
                    scrollToBottom();
                    localStorage.setItem('sharsh_welcome_shown', 'true');
                }
            }, 3000);
        });

        // Export chat function
        function exportChat() {
            const chatText = chatHistory.map(msg => 
                `${msg.role === 'user' ? 'You' : 'Sharsh'}: ${msg.content}`
            ).join('\n\n');
            
            const blob = new Blob([chatText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `sharsh-chat-${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            addMessage("I've exported our conversation as a text file.", 'ai');
        }

        // Add export button to controls
        document.addEventListener('DOMContentLoaded', function() {
            const exportBtn = document.createElement('button');
            exportBtn.className = 'control-btn';
            exportBtn.title = 'Export Chat';
            exportBtn.innerHTML = '<i class="fas fa-download"></i>';
            exportBtn.onclick = exportChat;
            document.querySelector('.chatbot-controls').appendChild(exportBtn);
        });
    </script>
</body>
</html>